<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Aloha+ Data Visualization</title>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

  <link href="dashboard.css" rel="stylesheet">

  <script src="http://d3js.org/d3.v3.min.js" language="JavaScript"></script>
  <script src="liquidFillGauge.js" language="JavaScript"></script>
  <style>
  .liquidFillGaugeText { font-family: Helvetica; font-weight: bold; }
  </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <a class="navbar-brand" href="#">Dashboard</a>
      <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Over View<span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Settings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Profile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Help</a>
          </li>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
          <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <nav class="col-sm-3 col-md-2 d-none d-sm-block bg-light sidebar">
          <ul class="nav nav-pills flex-column">
            <li class="nav-item">
              <a class="nav-link active" href="#">Aloha+Energy <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Aloha+Waste</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Aloha+Food</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Aloha+Nature</a>
            </li>
          </ul>
        </nav>

        <main class="col-sm-9 ml-sm-auto col-md-10 pt-3" role="main" id="main">
          <h1>Dashboard</h1>
  <p id="debug">debug</p>
          <svg id="canvas" width="1000" height="1000">
          </svg>
        </main>
      </div>
    </div>

  </body>
</html>

<script>

var data = [
  {label:"name1",val:50},
  {label:"name2",val:30},
  {label:"name3",val:20},
  {label:"name4",val:10},
  {label:"name5",val:56},
  {label:"name6",val:26}];
var dataid = "dt1";
var canv = d3.select("#canvas");

// start
var t_line_grow = 500;
var t_text_appear = 700;
var t_poly_grow = 700;

var orig_cx = 200;
var orig_cy = 200;
var radius = 150;
var num = data.length;
var max_val = Math.max.apply(null,data.map(function(d){return d.val;}));
var polysubid = ["back", "data"];

d3.selectAll("#debug").text("asdf");
d3.select("#main").selectAll("p").data(data).enter().append("p").text(function(d){return d.label;});

var lines = canv.selectAll("line").data(data).enter().append("line").attr("id",function(d){return dataid + "-" + d.label;});
var polygons = canv.selectAll("polygon").data(polysubid)
    .enter().append("polygon").attr("id",function(d){ return d; });
var back = canv.select("#back");
var poly = canv.select("#data");
var labels = canv.selectAll("text").data(data).enter().append("text")
    .attr("id",function(d){return dataid + "-" + d.label;})
    .text(function(d){return d.label;});

//initialize background polygon
back.attr("points",""+orig_cx+","+orig_cy).attr("opacity","0.3").attr("fill","gray")
  .attr("points",
    function() {
      return data.map(function(d,i) {
        return [
          radius*Math.cos(Math.PI*2/num*i-Math.PI/2)+orig_cx,
          radius*Math.sin(Math.PI*2/num*i-Math.PI/2)+orig_cy
        ].join(",");
      }).join(" ");
    });
//extend the lines
lines
  .attr("stroke","black").attr("stroke-width","2")
  .attr("x1",orig_cx).attr("y1",orig_cy)
  .attr("x2",orig_cx).attr("y2",orig_cy)
  .transition().duration(t_line_grow)
  .attr("x2",function(d,i){ return radius*Math.cos(Math.PI*2/num*i-Math.PI/2)+orig_cx; })
  .attr("y2",function(d,i){ return radius*Math.sin(Math.PI*2/num*i-Math.PI/2)+orig_cy; });
//display the labels
labels
  .attr("fill","white")
  .attr("x",function(d,i){ return (20+radius)*Math.cos(Math.PI*2/num*i-Math.PI/2)+orig_cx; })
  .attr("y",function(d,i){ return (20+radius)*Math.sin(Math.PI*2/num*i-Math.PI/2)+orig_cy; })
  .attr("text-anchor",function(d,i){
    if(i == 0 || i == num/2){ return "middle"; }
    else if(i < num/2){ return "start"; }
    else{ return "end"; }
  })
  .transition().delay(t_line_grow).duration(t_text_appear)
  .attr("fill","green");
//extend the polygon
poly
  .attr("points",
    function() {
      return data.map(function(d,i) {
        return [
          orig_cx,
          orig_cy
        ].join(",");
      }).join(" ");
    })
  .attr("opacity","0.4").attr("fill","green").transition().delay(t_line_grow).duration(t_poly_grow)
  .attr("points",
    function() {
      return data.map(function(d,i) {
        return [
          d.val*radius/max_val*Math.cos(Math.PI*2/num*i-Math.PI/2)+orig_cx,
          d.val*radius/max_val*Math.sin(Math.PI*2/num*i-Math.PI/2)+orig_cy
        ].join(",");
      }).join(" ");
    });



</script>
